---
title: [C#] RSA μ•”νΈν™”, λ³µνΈν™” 
date: 2024-06-11 +09:00
categories: [Tech, C#]
tags:
  [
  C#, RSA,μ•”νΈν™”, λ³µνΈν™”
  ]
image : ./assets/img/Cat/Cat_dev.png

hidden : false
---

## RSA

λ¨Όμ € `RSA`λ” μ „ μ„Έκ³„μ—μ„ κ°€μ¥ λ§μ΄ μ‚¬μ©λλ” **κ³µκ°ν‚¤ μ•”νΈ**  μ•κ³ λ¦¬μ¦μ΄λΌκ³ ν•λ‹¤. λ°©μ‹μ€ **κ³µκ°ν‚¤(public key)** λ” μ•”νΈν™” ν•λ”λ° μ“°μ΄λ©° , **κ°μΈν‚¤(private key)** λ” λ³µνΈν™”ν•λ”λ°μ— μ“°μΈλ‹¤. `RSA`λ” μ†μΈμ λ¶„ν•΄κ°€ μ“°μΈλ‹¤λ”λ° μν•™μ μΈ λ¶€λ¶„μ€ λ‹¤λ£¨μ§€ μ•μ„κ²ƒμ΄λ©° μμ λ¥Ό ν†µν•΄ C#μ—μ„ μ–΄λ–»κ² κµ¬ν„λλ”μ§€ μ‚΄ν΄λ³΄μ

<br>

> μμ λ” [RSACryptoServiceProvider](https://learn.microsoft.com/ko-kr/dotnet/api/system.security.cryptography.rsacryptoserviceprovider?view=net-6.0)λ¥Ό μ°Έκ³ ν•μ€λ‹¤.


## π“ κ°λ° ν™κ²½

* <img src="https://cdn3.emoji.gg/emojis/8574_visual_studio.png" alt="View" width="25" height="25"> VisualStudio 2022
* <img src="https://cdn3.emoji.gg/emojis/3846-dotnet.png" alt="View" width="25" height="25"> `.NET 6`
*  <img src="https://cdn3.emoji.gg/emojis/1739_CMD.png" alt="View" width="30" height="30">  `Console APP` 

## μ‹¤μµ

### RSACryptoServiceProvider ν΄λμ¤

CSP(μ•”νΈν™” μ„λΉ„μ¤ κ³µκΈ‰μ)κ°€ μ κ³µν•λ” RSA μ•κ³ λ¦¬μ¦μ κµ¬ν„μ„ μ‚¬μ©ν•μ—¬ λΉ„λ€μΉ­ μ•”νΈν™” λ° μ•”νΈν•΄λ…μ„ μ‹¤ν–‰ κ°€λ¥ν•¨


### μ•”νΈν™” 
```csharp
  public static byte[] RSAEncrypt(byte[] DataToEncrypt, RSAParameters RSAKeyInfo, bool DoOAEPPadding)
    {
        try
        {
            byte[] encryptedData;

            // μƒλ΅μ΄ RSACryptoServiceProvider μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±
            using (RSACryptoServiceProvider RSA = new RSACryptoServiceProvider())
            {
                //  κ³µκ°ν‚¤ μ •λ³΄λ§ ν•„μ”
                RSA.ImportParameters(RSAKeyInfo);

                // μ „λ‹¬λ λ°”μ΄νΈ λ°°μ—΄μ„ μ•”νΈν™”ν•κ³  OAEP ν¨λ”©μ„ μ§€μ •
                // OAEP ν¨λ”©μ€ Microsoft Windows XP μ΄μƒμ—μ„λ§ μ‚¬μ©ν•  μ μμ
                encryptedData = RSA.Encrypt(DataToEncrypt, DoOAEPPadding);
            }
            return encryptedData;
        }
        catch (CryptographicException e)
        {
            Console.WriteLine(e.Message);
            return null;
        }
    }
```

### λ³µνΈν™”
```csharp
 public static byte[] RSADecrypt(byte[] DataToDecrypt, RSAParameters RSAKeyInfo, bool DoOAEPPadding)
    {
        try
        {
            byte[] decryptedData;

            // μƒλ΅μ΄ RSACryptoServiceProvider μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±
            using (RSACryptoServiceProvider RSA = new RSACryptoServiceProvider())
            {
                 //  λΉ„λ°€ν‚¤ μ •λ³΄κ°€ ν•„μ”
                RSA.ImportParameters(RSAKeyInfo);

                // μ „λ‹¬λ λ°”μ΄νΈ λ°°μ—΄μ„ λ³µνΈν™”ν•κ³  OAEP ν¨λ”©μ„ μ§€μ •
                // OAEP ν¨λ”©μ€ Microsoft Windows XP μ΄μƒμ—μ„λ§ μ‚¬μ©ν•  μ μμ
                decryptedData = RSA.Decrypt(DataToDecrypt, DoOAEPPadding);
            }
            return decryptedData;
        }
        catch (CryptographicException e)
        {
            Console.WriteLine(e.ToString());
            return null;
        }
    }
```

### μ‚¬μ©μμ 
```csharp
 static void Main()
    {
        try
        {
        
            // λ¬Έμμ—΄κ³Ό λ°”μ΄νΈ λ°°μ—΄ κ°„μ λ³€ν™μ„ μ„ν•΄ UnicodeEncoding μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
            UnicodeEncoding ByteConverter = new UnicodeEncoding();
 
            // μ›λ³Έ λ°μ΄ν„°, μ•”νΈν™”λ λ°μ΄ν„°, λ³µνΈν™”λ λ°μ΄ν„°λ¥Ό μ €μ¥ν•  λ°”μ΄νΈ λ°°μ—΄μ„ μƒμ„±ν•©λ‹λ‹¤.
            byte[] dataToEncrypt = ByteConverter.GetBytes("RSA Sample");
            byte[] encryptedData;
            byte[] decryptedData;

     
            // κ³µκ°ν‚¤μ™€ λΉ„λ°€ν‚¤ λ°μ΄ν„°λ¥Ό μƒμ„±ν•κΈ° μ„ν•΄ RSACryptoServiceProviderμ μƒλ΅μ΄ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
            using (RSACryptoServiceProvider RSA = new RSACryptoServiceProvider())
            {
 
                // κ³µκ°ν‚¤ μ •λ³΄λ¥Ό μ‚¬μ©ν•μ—¬ λ°μ΄ν„°λ¥Ό μ•”νΈν™”ν•©λ‹λ‹¤.
                encryptedData = RSAEncrypt(dataToEncrypt, RSA.ExportParameters(false), false);

        
                // λΉ„λ°€ν‚¤ μ •λ³΄λ¥Ό μ‚¬μ©ν•μ—¬ λ°μ΄ν„°λ¥Ό λ³µνΈν™”ν•©λ‹λ‹¤.
                decryptedData = RSADecrypt(encryptedData, RSA.ExportParameters(true), false);
       
                // λ³µνΈν™”λ ν‰λ¬Έ λ°μ΄ν„°λ¥Ό μ½μ†”μ— μ¶λ ¥ν•©λ‹λ‹¤.
                Console.WriteLine("Decrypted plaintext: {0}", ByteConverter.GetString(decryptedData));
            }
        }
        catch (ArgumentNullException)
        {
            Console.WriteLine("Encryption failed.");
        }
    }

```

**RSA.ExportParameters(false)** λ” κ³µκ°ν‚¤λ¥Ό μƒμ„±ν•κ³   **RSA.ExportParameters(true)** λ” λΉ„λ°€ν‚¤λ¥Ό μƒμ„±ν•¨

### κ²°κ³Ό

![image](https://github.com/Gubeommo/TIL/assets/86589565/1ff8f1db-b883-44b2-b967-2eeef8a98d1e)


## μ¶μ²

[https://gngsn.tistory.com/96](https://gngsn.tistory.com/96)